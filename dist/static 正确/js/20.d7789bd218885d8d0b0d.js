webpackJsonp([20],{"9L1G":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("1onU"),i=a("gyMJ"),o={components:{Search:a("Vbaa").a,Pagination:l.a},data:function(){return{list:null,listLoading:!1,total:0,listQuery:{page:1,limit:10,importance:void 0,title:void 0,type:void 0,sort:"+id"},dialogVisible:!1,options:[{label:"顺丰",value:"顺丰"},{label:"圆通",value:"圆通"},{label:"申通",value:"申通"}],form:{agentId:"",phonenumber:null,buyNum:"",expressName:"",expressNo:"",cabinetNos:"",remark:"",outboundId:0,managerId:4},rules:{agentId:[{required:!0,message:"请选择加盟商",trigger:"change"}],phonenumber:[{type:"number",required:!0,message:"请输入购买人联系方式",trigger:"blur"}],buyNum:[{required:!0,message:"请输入购买数量",trigger:"blur"}],expressName:[{required:!0,message:"请选择快递公司",trigger:"change"}],expressNo:[{type:"number",required:!0,message:"请输入快递单号",trigger:"blur"}],cabinetNos:[{required:!0,message:"请输入设备编号",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]},cabinetsList:[],comboList:[],cabinetNos:[],changeNum:0,placeholder:"请输入姓名或手机号",keyword:"",dialogVisibleDevice:!1,listDevice:[],listLoadingDevice:!1}},mounted:function(){this.getList()},methods:{searchRecord:function(e){var t=this;this.dialogVisibleDevice=!0,this.listLoadingDevice=!0,Object(i.a)("/v1/platform/outbound/"+e.outboundId+"/cabinets").then(function(e){t.listLoadingDevice=!1,t.listDevice=e.data.resultData})},searchHandle:function(e){this.keyword=e,this.listQuery.page=1,this.getList()},handleChecked:function(e){this.changeNum=e.length;for(var t="",a=0;a<e.length;a++)t=0===a?e[a]:t+":"+e[a];this.form.cabinetNos=t},changeExpress:function(e){this.form.expressName=e},add:function(){this.dialogVisible=!0,this.form={},this.form.outboundId=0,this.getCabinetsList(),this.getComboList()},onSubmit:function(){var e=this;if(this.changeNum!==parseInt(this.form.buyNum))return this.$message.info("选择设备的数量与购买数量不相等"),!1;this.$refs.form.validate(function(t){e.form.managerId=4,t&&Object(i.a)("/v1/platform/outbound/"+e.form.outboundId,"post",e.form,"json").then(function(t){e.$message.success("保存成功"),e.getList(),e.dialogVisible=!1})})},getList:function(){var e=this;this.listLoading=!0,Object(i.a)("/v1/platform/outbound/outbounds?keyword="+this.keyword+"&pageNo="+this.listQuery.page+"&pageSize="+this.listQuery.limit).then(function(t){e.list=t.data.resultData.outbounds,e.total=t.data.resultData.totalNum,e.listLoading=!1})},getCabinetsList:function(){var e=this;Object(i.a)("/v1/platform/cabinet/inbound?cabinetStatus=INBOUND").then(function(t){console.log(t.data.resultData),e.cabinetsList=t.data.resultData})},getComboList:function(){var e=this;Object(i.a)("/v1/platform/agent/comboBox").then(function(t){console.log(t.data.resultData),e.comboList=t.data.resultData})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("search",{attrs:{placeholder:e.placeholder},on:{searchHandle:e.searchHandle}}),e._v(" "),e.isHasPermissions("AGENT_MANAGEMENT:OUTBOUND:ADD")?a("el-button",{staticStyle:{float:"right"},on:{click:e.add}},[e._v("新建记录")]):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading","highlight-current-row":"","header-cell-style":{background:"#F4F5F8",color:"#666666"}}},[a("el-table-column",{attrs:{prop:"agentId",align:"center",label:"ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentName",align:"center",label:"购买人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phonenumber",label:"联系电话",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"buyNum","class-name":"status-col",label:"购买数量",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createTime",label:"出库时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expressName",label:"物流公司"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expressNo",label:"物流单号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"设备编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.searchRecord(t.row)}}},[e._v("查看")])],1)]}}])})],1),e._v(" "),a("pagination",{attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e._v(" "),a("el-dialog",{attrs:{title:"新增记录",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"125px"}},[a("el-form-item",{attrs:{label:"购买人",prop:"agentId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.agentId,callback:function(t){e.$set(e.form,"agentId",t)},expression:"form.agentId"}},e._l(e.comboList,function(e){return a("el-option",{key:e.agentId,attrs:{label:e.agentName,value:e.agentId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"购买人联系方式",prop:"phonenumber"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.phonenumber,callback:function(t){e.$set(e.form,"phonenumber",e._n(t))},expression:"form.phonenumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"购买数量",prop:"buyNum"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.buyNum,callback:function(t){e.$set(e.form,"buyNum",t)},expression:"form.buyNum"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("台")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"快递公司",prop:"expressName"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.expressName,callback:function(t){e.$set(e.form,"expressName",t)},expression:"form.expressName"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"快递单号",prop:"expressNo"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.expressNo,callback:function(t){e.$set(e.form,"expressNo",e._n(t))},expression:"form.expressNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"设备选择",prop:"cabinetNos"}},[a("el-checkbox-group",{on:{change:e.handleChecked},model:{value:e.cabinetNos,callback:function(t){e.cabinetNos=t},expression:"cabinetNos"}},e._l(e.cabinetsList,function(t,l){return a("el-checkbox",{key:t.cabinetId,attrs:{label:t.cabinetNo}},[e._v("\r\n              "+e._s(t.cabinetNo)+"\r\n            ")])}),1),e._v("\r\n          已选择("+e._s(e.changeNum)+")台\r\n        ")],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提 交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"设备编号",visible:e.dialogVisibleDevice,width:"30%"},on:{"update:visible":function(t){e.dialogVisibleDevice=t}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoadingDevice,expression:"listLoadingDevice"}],attrs:{data:e.listDevice,"element-loading-text":"Loading","highlight-current-row":"","header-cell-style":{background:"#F4F5F8",color:"#666666"}}},[a("el-table-column",{attrs:{prop:"cabinetNo",align:"center",label:"设备编号"}})],1)],1)],1)},staticRenderFns:[]},n=a("VU/8")(o,r,!1,null,null,null);t.default=n.exports}});