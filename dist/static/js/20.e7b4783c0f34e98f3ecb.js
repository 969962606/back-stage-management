webpackJsonp([20],{q68P:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1onU"),a=r("gyMJ"),l={components:{Search:r("Vbaa").a,Pagination:s.a},data:function(){return{reissueStatusStr:{YES:"已补发",NO:"未补发"},list:null,listLoading:!1,total:0,listQuery:{page:1,limit:10,importance:void 0,title:void 0,type:void 0,sort:"+id"},dialogVisible:!1,form:{agentId:0,reissuenNum:"",expressNo:"",expressName:"顺丰",remark:""},options:[{label:"顺丰",value:"顺丰"},{label:"圆通",value:"圆通"},{label:"申通",value:"申通"}],rules:{agentId:[{type:"number",required:!0,message:"请输入代理商账号",triggle:"blur"}],reissuenNum:[{required:!0,message:"请输入补发数量",triggle:"blur"}],expressNo:[{required:!0,message:"请输入快递单号",triggle:"blur"}],expressName:[{required:!0,message:"请选择快递名称",triggle:"change"}],remark:[{required:!0,message:"请输入备注",triggle:"blur"}]},keyword:"",placeholder:"请输入姓名或手机号",formReject:{remark:""},rulesReject:{remark:[{required:!0,message:"请输入备注",triggle:"blur"}]},dialogVisibleReject:!1,reissueId:0,agentId:""}},mounted:function(){this.getList()},methods:{reject:function(e){this.dialogVisibleReject=!0,this.reissueId=e.reissueId,this.formReject.agentId=e.agentId},handleReject:function(){var e=this;this.formReject.auditStatus="REFUSE",this.$refs.formReject.validate(function(t){t&&Object(a.a)("/v1/platform/powerbank/reissue/"+e.reissueId,"put",e.formReject,"json").then(function(t){e.dialogVisibleReject=!1,e.$message.success("保存成功"),e.getList()})})},reissue:function(e){console.log(e,"补发"),this.dialogVisible=!0,this.reissueId=e.reissueId,this.form={},this.form.agentId=e.agentId},handleReissue:function(){var e=this;this.form.auditStatus="APPROVE",this.$refs.form.validate(function(t){t&&Object(a.a)("/v1/platform/powerbank/reissue/"+e.reissueId,"put",e.form,"json").then(function(t){e.dialogVisible=!1,e.$message.success("保存成功"),e.getList()})})},getList:function(){var e=this;Object(a.a)("/v1/platform/reissue/reissues?keyword="+this.keyword+"&pageNo="+this.listQuery.page+"&pageSize="+this.listQuery.limit).then(function(t){e.list=t.data.resultData.applyReissues,e.total=t.data.resultData.totalNum})},searchHandle:function(e){this.keyword=e,this.listQuery.page=1,this.getList()}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("search",{attrs:{placeholder:e.placeholder},on:{searchHandle:e.searchHandle}}),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading","highlight-current-rowId":"","header-cell-style":{background:"#F4F5F8",color:"#666666"}}},[r("el-table-column",{attrs:{prop:"reissueId",align:"center",label:"ID"}}),e._v(" "),r("el-table-column",{attrs:{prop:"agentName",align:"center",label:"姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phonenumber",label:"联系电话",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.reissueStatusStr[t.row.reissueStatus]))]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"applyNum",label:"申请数量"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"createTime",label:"申请时间"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"auditTime",label:"审批时间"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["PENDING"===t.row.auditStatus?r("div",[e.isHasPermissions("AGENT_MANAGEMENT:APPLY_REISSUE:AUDIT_STATUS")?r("div",[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.reissue(t.row)}}},[e._v("补发")]),e._v(" "),r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.reject(t.row)}}},[e._v("拒绝")])],1):e._e()]):r("div",[e._v("\r\n            "+e._s("APPROVE"===t.row.auditStatus?"已补发":"已拒绝")+"\r\n          ")])]}}])})],1),e._v(" "),r("pagination",{attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e._v(" "),r("el-dialog",{attrs:{title:"拒绝",visible:e.dialogVisibleReject,width:"30%"},on:{"update:visible":function(t){e.dialogVisibleReject=t}}},[r("el-form",{ref:"formReject",attrs:{model:e.formReject,rules:e.rulesReject}},[r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.formReject.remark,callback:function(t){e.$set(e.formReject,"remark",t)},expression:"formReject.remark"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleReject}},[e._v("完 成")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"补发充电宝",visible:e.dialogVisible,width:"30%",showClose:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"账号",prop:"agentId"}},[r("el-input",{attrs:{type:"number",disabled:!0},model:{value:e.form.agentId,callback:function(t){e.$set(e.form,"agentId",e._n(t))},expression:"form.agentId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"充电宝数量",prop:"reissuenNum"}},[r("el-input",{attrs:{type:"number"},model:{value:e.form.reissuenNum,callback:function(t){e.$set(e.form,"reissuenNum",t)},expression:"form.reissuenNum"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"快递单号",prop:"expressNo"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.expressNo,callback:function(t){e.$set(e.form,"expressNo",t)},expression:"form.expressNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"快递名称",prop:"expressName"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.expressName,callback:function(t){e.$set(e.form,"expressName",t)},expression:"form.expressName"}},e._l(e.options,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleReissue}},[e._v("完 成")])],1)],1)],1)},staticRenderFns:[]},o=r("VU/8")(l,i,!1,null,null,null);t.default=o.exports}});